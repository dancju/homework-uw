#!/usr/bin/env python3
from sage.all import exp, find_root, var

y_1, y_2, y_3, y_4, y_5 = var("y_1, y_2, y_3, y_4, y_5")
eqs = [
    1.0298 == 0.02*exp(-y_1*1/2)+1.02*exp(-y_1*2/2),
    1.0194 == 0.02*exp(-y_2*1/2)+0.02*exp(-y_2*2/2)+0.02*exp(-y_2*3/2)+1.02*exp(-y_2*4/2),
    1.0004 == 0.02*exp(-y_3*1/2)+0.02*exp(-y_3*2/2)+0.02*exp(-y_3*3/2)+0.02*exp(-y_3*4/2)+0.02*exp(-y_3*5/2)+1.02*exp(-y_3*6/2),
    0.9570 == 0.02*exp(-y_4*1/2)+0.02*exp(-y_4*2/2)+0.02*exp(-y_4*3/2)+0.02*exp(-y_4*4/2)+0.02*exp(-y_4*5/2)+0.02*exp(-y_4*6/2)+0.02*exp(-y_4*7/2)+0.02*exp(-y_4*8/2)+0.02*exp(-y_4*9/2)+1.02*exp(-y_4*10/2),
    0.8861 == 0.02*exp(-y_5*1/2)+0.02*exp(-y_5*2/2)+0.02*exp(-y_5*3/2)+0.02*exp(-y_5*4/2)+0.02*exp(-y_5*5/2)+0.02*exp(-y_5*6/2)+0.02*exp(-y_5*7/2)+0.02*exp(-y_5*8/2)+0.02*exp(-y_5*9/2)+0.02*exp(-y_5*10/2)+0.02*exp(-y_5*11/2)+0.02*exp(-y_5*12/2)+0.02*exp(-y_5*13/2)+0.02*exp(-y_5*14/2)+0.02*exp(-y_5*15/2)+0.02*exp(-y_5*16/2)+0.02*exp(-y_5*17/2)+0.02*exp(-y_5*18/2)+0.02*exp(-y_5*19/2)+1.02*exp(-y_5*20/2)
]

[y_1, y_2, y_3, y_4, y_5] = [find_root(eqs[i], 0, 1) for i in range(5)]

print(y_1, y_2, y_3, y_4, y_5)

macaulay_duration = [
    (0.02*1/2*exp(-y_1*1/2)+1.02*2/2*exp(-y_1*2/2)) / 1.0298,
    (0.02*1/2*exp(-y_2*1/2)+0.02*2/2*exp(-y_2*2/2)+0.02*3/2*exp(-y_2*3/2)+1.02*4/2*exp(-y_2*4/2)) / 1.0194,
    (0.02*1/2*exp(-y_3*1/2)+0.02*2/2*exp(-y_3*2/2)+0.02*3/2*exp(-y_3*3/2)+0.02*4/2*exp(-y_3*4/2)+0.02*5/2*exp(-y_3*5/2)+1.02*6/2*exp(-y_3*6/2)) / 1.0004,
    (0.02*1/2*exp(-y_4*1/2)+0.02*2/2*exp(-y_4*2/2)+0.02*3/2*exp(-y_4*3/2)+0.02*4/2*exp(-y_4*4/2)+0.02*5/2*exp(-y_4*5/2)+0.02*6/2*exp(-y_4*6/2)+0.02*7/2*exp(-y_4*7/2)+0.02*8/2*exp(-y_4*8/2)+0.02*9/2*exp(-y_4*9/2)+1.02*10/2*exp(-y_4*10/2)) / 0.9570,
    (0.02*1/2*exp(-y_5*1/2)+0.02*2/2*exp(-y_5*2/2)+0.02*3/2*exp(-y_5*3/2)+0.02*4/2*exp(-y_5*4/2)+0.02*5/2*exp(-y_5*5/2)+0.02*6/2*exp(-y_5*6/2)+0.02*7/2*exp(-y_5*7/2)+0.02*8/2*exp(-y_5*8/2)+0.02*9/2*exp(-y_5*9/2)+0.02*10/2*exp(-y_5*10/2)+0.02*11/2*exp(-y_5*11/2)+0.02*12/2*exp(-y_5*12/2)+0.02*13/2*exp(-y_5*13/2)+0.02*14/2*exp(-y_5*14/2)+0.02*15/2*exp(-y_5*15/2)+0.02*16/2*exp(-y_5*16/2)+0.02*17/2*exp(-y_5*17/2)+0.02*18/2*exp(-y_5*18/2)+0.02*19/2*exp(-y_5*19/2)+1.02*20/2*exp(-y_5*20/2)) / 0.8861
]

print(macaulay_duration)
